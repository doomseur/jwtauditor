/*!
 * JWTAuditor - Working Production JWT Bruteforcer Module (Obfuscated)
 * https://github.com/dr34mhacks/jwtauditor
 * Copyright (c) 2025 Sid Joshi (@dr34mhacks)
 * Licensed under Apache-2.0 License
 */
!function(g){var v={a:'token',b:'header',c:'payload',d:'signature',e:'algorithm',f:'wordlist',g:'isRunning',h:'shouldStop',i:'progress',j:'nonHmacAlgorithmDetected',k:'detectedAlgorithm',l:'defaultWordlist',m:'signingInput',n:'expectedSignature',o:'batchSize',p:'customWordlist',q:'loadDefaultWordlist',r:'init',s:'setCustomWordlist',t:'setWordlist',u:'start',v:'_startBruteforce',w:'processBatch',x:'testSecretFast',y:'testSecret',z:'stop'};function B(){this[v.a]=null;this[v.b]=null;this[v.c]=null;this[v.d]=null;this[v.e]=null;this[v.f]=[];this[v.p]=null;this[v.g]=false;this[v.h]=false;this[v.i]=0;this[v.j]=false;this[v.k]=null;this[v.l]=null;this[v.m]=null;this[v.n]=null;this[v.o]=100;this._author='dr34mhacks';this._repo='https://github.com/dr34mhacks/jwtauditor';}B.prototype[v.q]=async function(){if(this[v.l])return this[v.l];try{var r=await fetch('jwt_auditor_potential_secrets.txt');if(!r.ok)throw new Error('HTTP '+r.status+': '+r.statusText);var t=await r.text();this[v.l]=t.split('\n').map(function(l){return l.trim();}).filter(function(l){return l.length>0;});return this[v.l];}catch(e){this[v.l]=['secret','password','123456','admin','test','key','jwt','token','default','qwerty','your-256-bit-secret','supersecret','mySecretKey','jwt_secret','secretkey','mysecret','jwtsecret','secret123','password123','testkey','demo','sample','example','dev','development','prod','production','staging','local','localhost','app','application','service','api'];return this[v.l];}};B.prototype[v.r]=function(t){try{this[v.a]=t;var d=jwtDecoder.decode(t);this[v.b]=d.header;this[v.c]=d.payload;this[v.d]=d.signature;this[v.e]=this[v.b].alg;this[v.j]=false;this[v.k]=this[v.e];if(this[v.e]!=='none'&&!this[v.e].startsWith('HS')){this[v.j]=true;return false;}var p=t.split('.');this[v.m]=p[0]+'.'+p[1];this[v.n]=p[2];return true;}catch(e){return false;}};B.prototype[v.s]=function(w){this[v.p]=w.split('\n').map(function(l){return l.trim();}).filter(function(l){return l.length>0;});};B.prototype[v.t]=function(w){this[v.s](w);};B.prototype[v.u]=function(m,pc,rc){if(arguments.length===2){return this[v.v]('dictionary',m,pc);}else{return this[v.v](m,pc,rc);}};B.prototype[v.v]=async function(m,pc,rc){if(this[v.g])return;this[v.g]=true;this[v.h]=false;this[v.i]=0;try{if(m==='custom'&&this[v.p]){this[v.f]=this[v.p];}else{this[v.f]=await this[v.q]();}var ts=this[v.f].length;var td=0;pc(0);for(var i=0;i<this[v.f].length;i+=this[v.o]){if(this[v.h])break;var b=this[v.f].slice(i,i+this[v.o]);var r=await this[v.w](b);if(r.found){rc({success:true,secret:r.secret});this[v.g]=false;return;}td+=b.length;this[v.i]=Math.floor((td/ts)*100);pc(this[v.i]);await new Promise(function(res){setTimeout(res,0);});}rc({success:false,error:'No matching secret found in the wordlist.'});this[v.g]=false;}catch(e){rc({success:false,error:e.message});this[v.g]=false;}};B.prototype[v.w]=async function(s){var pr=s.map(function(sec){return this[v.x](sec);}.bind(this));var rs=await Promise.all(pr);for(var i=0;i<rs.length;i++){if(rs[i]){return{found:true,secret:s[i]};}}return{found:false};};B.prototype[v.x]=function(s){try{if(this[v.e]==='HS256'){var sig=CryptoJS.HmacSHA256(this[v.m],s);var b64=CryptoJS.enc.Base64.stringify(sig).replace(/\+/g,'-').replace(/\//g,'_').replace(/=/g,'');return b64===this[v.n];}else if(this[v.e]==='HS384'){var sig=CryptoJS.HmacSHA384(this[v.m],s);var b64=CryptoJS.enc.Base64.stringify(sig).replace(/\+/g,'-').replace(/\//g,'_').replace(/=/g,'');return b64===this[v.n];}else if(this[v.e]==='HS512'){var sig=CryptoJS.HmacSHA512(this[v.m],s);var b64=CryptoJS.enc.Base64.stringify(sig).replace(/\+/g,'-').replace(/\//g,'_').replace(/=/g,'');return b64===this[v.n];}return false;}catch(e){return false;}};B.prototype[v.y]=function(s){return this[v.x](s);};B.prototype[v.z]=function(){this[v.h]=true;this[v.g]=false;};g.jwtBruteforcer=new B();}(window);